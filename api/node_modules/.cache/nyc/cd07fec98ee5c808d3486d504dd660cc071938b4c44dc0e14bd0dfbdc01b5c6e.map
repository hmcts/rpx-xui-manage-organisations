{"version":3,"file":"/home/alan/Cloud/workspaces/prd-pui-manager/api/lib/log4jui.ts","sources":["/home/alan/Cloud/workspaces/prd-pui-manager/api/lib/log4jui.ts"],"names":[],"mappings":";;AAAA,+BAAgC;AAChC,mCAA6B;AAC7B,8CAA+C;AAC/C,6CAAsC;AAGtC,IAAI,MAAM,GAAG,IAAI,CAAA;AAEjB,qCAAqC;AAErC,mBAA0B,QAAgB;IACtC,MAAM,GAAG,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAA;IACnC,MAAM,CAAC,KAAK,GAAG,gBAAM,CAAC,OAAO,IAAI,KAAK,CAAA;IAEtC,OAAO;QACH,OAAO,EAAE,MAAM;QACf,KAAK,OAAA;QACL,KAAK,OAAA;QACL,IAAI,MAAA;QACJ,YAAY,cAAA;QACZ,IAAI,MAAA;KACP,CAAA;AACL,CAAC;AAZD,8BAYC;AAED;IAAc,kBAAkB;SAAlB,UAAkB,EAAlB,qBAAkB,EAAlB,IAAkB;QAAlB,6BAAkB;;IAC5B,IAAI,WAAW,GAAG,EAAE,CAAA;IAEpB,KAAsB,UAAQ,EAAR,qBAAQ,EAAR,sBAAQ,EAAR,IAAQ,EAAE;QAA3B,IAAM,OAAO,iBAAA;QACd,WAAW,IAAI,OAAO,CAAA;KACzB;IAED,IAAM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAA;IACtC,IAAI,oBAAM,EAAE;QACR,oBAAM,CAAC,UAAU,CAAC,EAAE,OAAO,EAAE,YAAU,QAAQ,WAAM,WAAa,EAAE,CAAC,CAAA;KACxE;IACD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,CAAA;AAClC,CAAC;AAED;IAAc,kBAAkB;SAAlB,UAAkB,EAAlB,qBAAkB,EAAlB,IAAkB;QAAlB,6BAAkB;;IAC5B,IAAI,WAAW,GAAG,EAAE,CAAA;IAEpB,KAAsB,UAAQ,EAAR,qBAAQ,EAAR,sBAAQ,EAAR,IAAQ,EAAE;QAA3B,IAAM,OAAO,iBAAA;QACd,WAAW,IAAI,OAAO,CAAA;KACzB;IAED,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,CAAA;AAClC,CAAC;AAED;IAAe,kBAAkB;SAAlB,UAAkB,EAAlB,qBAAkB,EAAlB,IAAkB;QAAlB,6BAAkB;;IAC7B,IAAI,WAAW,GAAG,EAAE,CAAA;IAEpB,KAAsB,UAAQ,EAAR,qBAAQ,EAAR,sBAAQ,EAAR,IAAQ,EAAE;QAA3B,IAAM,OAAO,iBAAA;QACd,WAAW,IAAI,OAAO,CAAA;KACzB;IACD,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,WAAW,CAAC,CAAA;AACnC,CAAC;AAED,sBAAsB,GAAQ;IAC1B,IAAI,oBAAM,EAAE;QACR,oBAAM,CAAC,YAAY,CAAC,GAAG,CAAC,CAAA;KAC3B;AACL,CAAC;AAED;IAAe,kBAAkB;SAAlB,UAAkB,EAAlB,qBAAkB,EAAlB,IAAkB;QAAlB,6BAAkB;;IAC7B,IAAI,WAAW,GAAG,EAAE,CAAA;IAEpB,KAAsB,UAAQ,EAAR,qBAAQ,EAAR,sBAAQ,EAAR,IAAQ,EAAE;QAA3B,IAAM,OAAO,iBAAA;QACd,WAAW,IAAI,OAAO,CAAA;KACzB;IAED,IAAM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAA;IACtC,IAAI,oBAAM,EAAE;QACR,oBAAM,CAAC,cAAc,CAAC,EAAE,SAAS,EAAE,IAAI,KAAK,CAAC,aAAW,QAAQ,WAAM,WAAa,CAAC,EAAE,CAAC,CAAA;KAC1F;IACD,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,WAAW,CAAC,CAAA;IAE/B,IAAI,gBAAM,CAAC,OAAO,KAAK,OAAO,IAAI,gBAAM,CAAC,OAAO,KAAK,OAAO,EAAE;QAC1D,UAAU,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAC,CAAA;KAC3C;AACL,CAAC","sourcesContent":["import * as log4js from 'log4js'\nimport config from './config'\nimport * as errorStack from '../lib/errorStack'\nimport { client } from './appInsights'\n\n\nlet logger = null\n\n// This is done to mimic log4js calls\n\nexport function getLogger(category: string) {\n    logger = log4js.getLogger(category)\n    logger.level = config.logging || 'off'\n\n    return {\n        _logger: logger,\n        debug,\n        error,\n        info,\n        trackRequest,\n        warn,\n    }\n}\n\nfunction info(...messages: any[]) {\n    let fullMessage = ''\n\n    for (const message of messages) {\n        fullMessage += message\n    }\n\n    const category = this._logger.category\n    if (client) {\n        client.trackTrace({ message: `[INFO] ${category} - ${fullMessage}` })\n    }\n    this._logger.info(fullMessage)\n}\n\nfunction warn(...messages: any[]) {\n    let fullMessage = ''\n\n    for (const message of messages) {\n        fullMessage += message\n    }\n\n    this._logger.warn(fullMessage)\n}\n\nfunction debug(...messages: any[]) {\n    let fullMessage = ''\n\n    for (const message of messages) {\n        fullMessage += message\n    }\n    this._logger.debug(fullMessage)\n}\n\nfunction trackRequest(obj: any) {\n    if (client) {\n        client.trackRequest(obj)\n    }\n}\n\nfunction error(...messages: any[]) {\n    let fullMessage = ''\n\n    for (const message of messages) {\n        fullMessage += message\n    }\n\n    const category = this._logger.category\n    if (client) {\n        client.trackException({ exception: new Error(`[ERROR] ${category} - ${fullMessage}`) })\n    }\n    this._logger.error(fullMessage)\n\n    if (config.logging === 'debug' || config.logging === 'error') {\n        errorStack.push([category, fullMessage])\n    }\n}\n\n"]}