@if (isPageValid && formDraft.invalid) {
  <app-validation-header [validationHeaderErrorMessages]="this.pageItems.validationHeaderErrorMessages" [formGroup]="formDraft">
  </app-validation-header>
}

@if (pageItems) {
  <form [formGroup]="formDraft" (ngSubmit)="onFormSubmit()">
    <div [ngClass]="{'govuk-form-group':true, 'govuk-form-group--error' : isPageValid && formDraft.invalid }">
      @if (!isLegendAvailable) {
        <h1 class="govuk-heading-xl">
          @if (pageItems.caption) {
            <span [class]="pageItems.caption.classes">{{ pageItems.caption.text }}</span>
          }
          {{pageItems.header}}
        </h1>
      }
      @for (group of pageItems.groups; track group) {
        <div class="govuk-form-group">
          @if (group.fieldset) {
            <app-fieldset
              [classes]="'govuk-fieldset'"
              [group]="formDraft"
              [data]="group.fieldset"
              [validate]="isPageValid">
            </app-fieldset>
          }
          <app-jui-form-elements [group]="formDraft"
            [validate]="isPageValid"
            [data]="group"
            (btnClick)="onBtnClick($event)"
            (blurCast)="onBlur($event)"
          ></app-jui-form-elements>
        </div>
      }
    </div>
  </form>
}
